"0","sexgenes = c(""g0s2"",""ptprc"") #normally set to Xist and Tsix"
"0","sex = GetAssayData(sobject,slot = ""counts"")[sexgenes,]"
"0",""
"0","#now you have a 2-row array with a number of counts per cell; split by whether counts are >1 or <1"
"0","female = sex[,sex[1,]>1 & sex[2,] > 1]"
"0",""
"0","#get all the cell names from your seurat object"
"0","cells = colnames(sobject)"
"0","names(cells) = rep(""Male"",length(cells))"
"0","names(cells)[cells %in% colnames(female)] = ""Female"""
"0",""
"0","fm = names(cells)"
"0","table(fm)"
"1","fm
"
"1","Female "
"1","  Male "
"1","
"
"1","   698 "
"1"," 22845 "
"1","
"
"0","#add in a new metadata column"
"0","sobject$sex = fm"
"0",""
"0","#Check with a violin plot"
"0","VlnPlot(sobject,sexgenes,group.by = ""sex"")"
