"0","annotation = peaks$Detailed.Annotation"
"0","rpt = grep(""repeat"",annotation)"
"0","names(rpt) = rep(""Repeat"",length(rpt))"
"0",""
"0","#pull out different kinds of annotations"
"0","prom = grep(""promoter"",annotation)"
"0","names(prom) = rep(""Promoter"",length(prom))"
"0",""
"0","intergenic = grep(""Intergenic"",annotation)"
"0","names(intergenic) = rep(""Intergenic"",length(intergenic))"
"0",""
"0","cpg = grep(""CpG"",annotation)"
"0","names(cpg) = rep(""CpG"",length(cpg))"
"0",""
"0","utr3 = grep(""3' UTR"",annotation)"
"0","names(utr3) = rep(""UTR3"",length(utr3))"
"0",""
"0","utr5 = grep(""5' UTR"",annotation)"
"0","names(utr5) = rep(""UTR5"",length(utr5))"
"0",""
"0","exon = grep(""exon"",annotation)"
"0","names(exon) = rep(""Exon"",length(exon))"
"0","exon = exon[!exon %in% c(utr3,utr5)]"
"0",""
"0","intron = grep(""intron"",annotation)"
"0","names(intron) = rep(""Intron"",length(intron))"
"0",""
"0","tts = grep(""TTS"",annotation)"
"0","names(tts) = rep(""TTS"",length(tts))"
"0",""
"0","annotationfull = c(rpt,exon,prom,intergenic,cpg,utr3,utr5,intron,tts)"
"0","annotationfull = annotationfull[order(annotationfull)]"
"0",""
"0","annotation[annotationfull] = names(annotationfull)"
